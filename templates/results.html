{% extends 'layout.html' %}
{% block content %}

<div class="content">
    <div class="search-controls">

        <form method="GET" action="{{ url_for('main.results') }}" id="searchForm">
            <input type="text" name="search" id="search" placeholder="Search results" autocomplete="off" />

            <label for="rows_per_page">Rows per page:</label>
            <select name="per_page" id="per_page" onchange="document.getElementById('searchForm').submit();">
                {% for value, label in pagination_options %}
                <option value="{{ value }}" {{ 'selected' if per_page==value else '' }}>{{ label }}</option>
                {% endfor %}
            </select>

    </div>

    <div class="results_info">

        {% if search_query %}
        <p>Search results for: "<strong>{{ search_query }}</strong>" - {{ results.total }} result(s) found</p>
        {% else %}
        <p>Showing {{ results.total }} total results</p>
        {% endif %}

        <p>
            Page {{ results.page }} of {{ results.pages }}
            (showing {{ results.per_page }} per page)
        </p>
    </div>
    <table id="resultsTable">
        <tr>
            <th>ID</th>
            <th>Entries_id</th>
            <th>Competition</th>
            <th>Name</th>
            <th>Club</th>
            <th>Apparatus</th>
            <th>Execution</th>
            <th>Difficulty</th>
            <th>Penalty</th>
            <th>Total</th>
        </tr>

        {% for row in results.items %}

        <tr>
            <td>{{ row.id}}</td>
            <td>{{ row.entries_id }}</td>
            <td>{{ row.entry.competitions.name }}</td>
            <td>{{ row.entry.gymnasts.name }}</td>
            <td>{{ row.entry.gymnasts.clubs.name }}</td>
            <td>{{ row.apparatus_name.name }}</td>
            <td>{{ row.e_score }}</td>
            <td>{{ row.d_score }}</td>
            <td>{{ row.penalty }}</td>
            <td>{{ row.total }}</td>
        </tr>
        {% endfor %}
    </table>

    <div class="pagination">

        {% if results.has_prev %}
        <a href="{{ url_for('main.results', page=results.prev_num, per_page=per_page) }}">Previous</a>
        {% endif %}
        {% for num in results.iter_pages() %}
        {% if num %}
        <a href="{{ url_for('main.results', page=num, per_page=per_page) }}">{{ num }}</a>
        {% else %}
        ...
        {% endif %}
        {% endfor %}
        {% if results.has_next %}
        <a href="{{url_for('main.results', page=results.next_num, per_page=per_page) }}">Next</a>
        {% endif %}

    </div>
</div><!--content-->
{% endblock %}