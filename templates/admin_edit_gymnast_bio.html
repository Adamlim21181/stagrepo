{% extends 'layout.html' %}
{% block content %}

<div class="auth-page admin-bio-edit-page">
    <div class="auth-container">
        <!-- Header Section -->
        <div class="auth-header">
            <div class="auth-logo">
                <div class="logo-circle">
                    <span class="logo-text"></span>
                </div>
            </div>
            <h1>Edit Gymnast Bio</h1>
            <p class="auth-subtitle">Admin editing for {{ gymnast.name }}</p>
        </div>

        <!-- Bio Form -->
        <form method="POST" class="auth-form admin-bio-form">
            {{ form.hidden_tag() }}

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            <div class="flash-messages">
                {% for category, message in messages %}
                <div class="flash-message flash-{{ category }}">
                    <span class="flash-icon">
                        {% if category == 'error' %}!{% elif category == 'success' %}{% else %}i{% endif %}
                    </span>
                    {{ message }}
                </div>
                {% endfor %}
            </div>
            {% endif %}
            {% endwith %}

            <!-- Current Info Display -->
            <div class="current-info">
                <h3>{{ gymnast.name }}</h3>
                <p><strong>Current Club:</strong> {{ gymnast.clubs.name if gymnast.clubs else 'N/A' }}</p>
                <p><strong>Current Level:</strong> {{ gymnast.level or 'N/A' }}</p>
                <p><strong>Current Age:</strong> {{ gymnast.age or 'N/A' }}</p>
            </div>

            <!-- Competition Details Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <span class="section-icon"></span>
                    Competition Details
                </h3>

                <div class="form-group">
                    {{ form.club_name.label(class="form-label") }}
                    {{ form.club_name(class="form-control", placeholder="Enter club name") }}
                    <small class="field-hint">The gymnastics club they compete for</small>
                    {% if form.club_name.errors %}
                    <div class="field-errors">
                        {% for error in form.club_name.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.level.label(class="form-label") }}
                    {{ form.level(class="form-control") }}
                    <small class="field-hint">Their current competition level</small>
                    {% if form.level.errors %}
                    <div class="field-errors">
                        {% for error in form.level.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.age.label(class="form-label") }}
                    {{ form.age(class="form-control", placeholder="e.g. 16") }}
                    <small class="field-hint">Their current age</small>
                    {% if form.age.errors %}
                    <div class="field-errors">
                        {% for error in form.age.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Bio Details Section -->
            <div class="form-section">
                <h3 class="section-title">
                    <span class="section-icon"></span>
                    Bio Details
                </h3>

                <div class="form-group">
                    {{ form.goals.label(class="form-label") }}
                    {{ form.goals(class="form-control", placeholder="What are their gymnastics goals and aspirations?")
                    }}
                    <small class="field-hint">Their future goals and aspirations</small>
                    {% if form.goals.errors %}
                    <div class="field-errors">
                        {% for error in form.goals.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.achievements.label(class="form-label") }}
                    {{ form.achievements(class="form-control", placeholder="List their medals, championships, and
                    notable achievements") }}
                    <small class="field-hint">Their proudest moments and accomplishments</small>
                    {% if form.achievements.errors %}
                    <div class="field-errors">
                        {% for error in form.achievements.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>

                <div class="form-group">
                    {{ form.injuries.label(class="form-label") }}
                    {{ form.injuries(class="form-control", placeholder="Any current injuries or medical notes") }}
                    <small class="field-hint">Medical information for competition planning</small>
                    {% if form.injuries.errors %}
                    <div class="field-errors">
                        {% for error in form.injuries.errors %}
                        <span class="error-message">{{ error }}</span>
                        {% endfor %}
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Admin Note -->
            <div class="admin-note">
                <h4>Admin Note</h4>
                <p>ðŸ”’ This information will be updated on {{ gymnast.name }}'s public profile and linked user account
                    (if any).</p>
                {% if gymnast.user %}
                <p>ðŸ“§ Linked User: {{ gymnast.user.first_name }} {{ gymnast.user.last_name }} ({{ gymnast.user.email }})
                </p>
                {% else %}
                <p>ðŸ‘¤ No linked user account</p>
                {% endif %}
            </div>

            <!-- Form Actions -->
            <div class="form-actions">
                {{ form.submit(class="btn btn-primary") }}
                <a href="{{ url_for('main.gymnasts') }}" class="btn btn-secondary">Cancel</a>
            </div>
        </form>
    </div>
</div>

<style>
    .admin-bio-edit-page .auth-container {
        max-width: 700px;
    }

    .current-info {
        background: rgba(76, 175, 80, 0.1);
        border: 2px solid var(--primary-green);
        border-radius: var(--border-radius-sm);
        padding: var(--spacing-md);
        margin-bottom: var(--spacing-lg);
        text-align: center;
    }

    .current-info h3 {
        color: var(--primary-green);
        margin-bottom: var(--spacing-sm);
    }

    .current-info p {
        margin-bottom: var(--spacing-xs);
        color: var(--text-muted);
    }

    .field-hint {
        display: block;
        color: var(--text-muted);
        font-size: var(--font-size-xs);
        margin-top: var(--spacing-xs);
        font-style: italic;
    }

    .admin-note {
        background: var(--background-light);
        padding: var(--spacing-md);
        border-radius: var(--border-radius-sm);
        margin-bottom: var(--spacing-lg);
        border-left: 4px solid #ff9800;
    }

    .admin-note h4 {
        color: #ff9800;
        margin-bottom: var(--spacing-sm);
    }

    .admin-note p {
        color: var(--text-muted);
        margin-bottom: var(--spacing-xs);
    }

    /* Make text areas larger for longer content */
    .admin-bio-form textarea.form-control {
        min-height: 80px;
        resize: vertical;
    }

    .form-actions {
        display: flex;
        gap: var(--spacing-md);
        justify-content: center;
        align-items: center;
        margin-top: var(--spacing-xl);
        padding-top: var(--spacing-md);
    }

    @media (max-width: 768px) {
        .form-actions {
            flex-direction: column;
            gap: var(--spacing-sm);
        }

        .form-actions .btn {
            width: 100%;
        }
    }
</style>

{% endblock %}