{% extends 'layout.html' %}
{% block title %}Home - SMART{% endblock %}
{% block content %}

<div class="content">
    <section class="hero-section">
        <div class="hero-content">
            <h1 class="hero-title">STAG Compete</h1>
            <p class="hero-subtitle">Comprehensive gymnastics competition management and live scoring</p>

            {% if not current_user.is_authenticated %}
            <div class="hero-cta">
                <a href="{{ url_for('main.register') }}" class="btn btn-primary btn-large">Get Started Free</a>
                <p class="cta-text">Join the STAG gymnastics community today</p>
            </div>
            {% endif %}

            {% if live_competitions %}
            <div class="live-alert">
                <span class="live-badge">LIVE</span>
                {% for comp in live_competitions %}
                <strong>{{ comp.name }} is currently running!</strong>
                {% endfor %}
                <a href="{{ url_for('main.live') }}" class="btn btn-primary">View Live Leaderboard</a>
            </div><!-- live-alert -->
            {% endif %}
        </div><!-- hero-content -->
    </section><!-- hero-section -->

    {% if not current_user.is_authenticated %}
    <!-- Features Overview for Visitors -->
    <section class="features-overview">
        <h2>What You Get with STAG Compete</h2>
        <div class="features-grid">
            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3>Competition Results</h3>
                <p>Access detailed competition results, rankings, and performance analytics</p>
                <span class="members-only">Members Only</span>
            </div>

            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3>Live Leaderboard</h3>
                <p>Follow ongoing competitions in real-time with live scoring updates</p>
                <a href="{{ url_for('main.live') }}" class="btn btn-secondary">View Live</a>
            </div>

            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3>Competition Calendar</h3>
                <p>Stay updated with upcoming competitions, dates, and registration deadlines</p>
                <span class="members-only">Members Only</span>
            </div>

            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3>Gymnast Profiles</h3>
                <p>Track your progress, achievements, and competition history</p>
                <span class="members-only">Members Only</span>
            </div>

            <div class="feature-card">
                <div class="feature-icon"></div>
                <h3>Apply to Compete</h3>
                <p>Submit applications to participate in STAG gymnastics competitions</p>
                <span class="members-only">Members Only</span>
            </div>

            <div class="feature-card signup-highlight">
                <div class="feature-icon"></div>
                <h3>Ready to Join?</h3>
                <p>Create your free account to access all STAG features and join our gymnastics community</p>
                <div class="signup-actions">
                    <a href="{{ url_for('main.register') }}" class="btn btn-primary">Sign Up Free</a>
                    <p class="login-link">Already have an account? <a href="{{ url_for('main.login') }}">Login here</a>
                    </p>
                </div>
            </div>
        </div>
    </section>

    {% else %}
    <!-- Dashboard for Authenticated Users -->
    <section class="user-dashboard-section">
        <h2>Your Dashboard</h2>
        <div class="action-grid">
            <div class="action-card">
                <h3>Results</h3>
                <p>View competition results and standings</p>
                <a href="{{ url_for('main.results') }}" class="btn btn-secondary">View Results</a>
            </div>

            <div class="action-card">
                <h3>Live Leaderboard</h3>
                <p>Follow ongoing competitions in real-time</p>
                <a href="{{ url_for('main.live') }}" class="btn btn-secondary">Live Scores</a>
            </div>

            <div class="action-card">
                <h3>Calendar</h3>
                <p>Check upcoming competition dates</p>
                <a href="{{ url_for('main.calendar_view') }}" class="btn btn-secondary">View Calendar</a>
            </div>
        </div>
    </section>
    {% endif %}

    {% if upcoming_competitions %}
    <section class="upcoming-section">
        <h2>Upcoming Competitions</h2>
        <div class="competition-grid">
            {% for competition in upcoming_competitions %}
            <div class="competition-card">
                <div class="competition-status {{ competition.status }}">
                    {{ competition.status.title() }}
                </div><!-- competition-status -->
                <h3>{{ competition.name }}</h3>
                <div class="competition-details">
                    <p><strong>Date:</strong>
                        {% if competition.competition_date %}
                        {{ competition.competition_date.strftime('%B %d, %Y') }}
                        {% else %}
                        TBD
                        {% endif %}
                    </p>
                    <p><strong>üìç Location:</strong> {{ competition.address }}</p>
                </div><!-- competition-details -->
                <a href="{{ url_for('main.competition_details', competition_id=competition.id) }}"
                    class="btn btn-outline">View Details</a>
            </div><!-- competition-card -->
            {% endfor %}
        </div><!-- competition-grid -->
    </section><!-- upcoming-section -->
    {% endif %}

    {% if recent_results %}
    <section class="recent-results">
        <h2>Recent Results</h2>
        <div class="results-grid">
            {% for competition in recent_results %}
            <div class="result-card">
                <h3>{{ competition.name }}</h3>
                <div class="result-info">
                    <p><strong>Completed:</strong>
                        {% if competition.ended_at %}
                        {{ competition.ended_at.strftime('%B %d, %Y') }}
                        {% else %}
                        Recently
                        {% endif %}
                    </p>
                    <p><strong>Location:</strong> {{ competition.address }}</p>
                </div><!-- result-info -->
                <a href="{{ url_for('main.competition_details', competition_id=competition.id) }}"
                    class="btn btn-outline">View Results</a>
            </div><!-- result-card -->
            {% endfor %}
        </div><!-- results-grid -->
        <div class="view-all">
            <a href="{{ url_for('main.results') }}" class="btn btn-secondary">View All Results</a>
        </div><!-- view-all -->
    </section><!-- recent-results -->
    {% endif %}



    {% if current_user.is_authenticated %}
    <section class="user-panel">
        <h2>Welcome back, {{ current_user.first_name }}! üëã</h2>

        {% if current_user.is_admin %}
        <div class="admin-dashboard">
            <h3>Administration</h3>
            <div class="admin-actions">
                <a href="{{ url_for('main.admin_users') }}" class="admin-card">
                    User Management
                </a>
                <a href="{{ url_for('main.competitions') }}" class="admin-card">
                    Manage Competitions
                </a>
                <a href="{{ url_for('main.entries') }}" class="btn btn-primary">
                    Manage Entries
                </a>
            </div>
        </div>
        {% endif %}

        {% if current_user.is_judge_or_admin %}
        <div class="judge-dashboard">
            <h3>Judging Tools</h3>
            <div class="judge-actions">
                <a href="{{ url_for('main.scoring') }}" class="judge-card">
                    Score Management
                </a>
                <a href="{{ url_for('main.live') }}" class="btn btn-secondary">
                    Live Leaderboard
                </a>
            </div>
        </div>
        {% endif %}

        {% if not current_user.is_admin and not current_user.is_judge_or_admin %}
        <div class="user-dashboard">
            <h3>Your STAG Experience</h3>
            <p class="dashboard-text">Welcome to the STAG community! Explore competition results, check upcoming events,
                and stay connected with gymnastics.</p>
            <div class="user-actions">
                <a href="{{ url_for('main.results') }}" class="btn btn-secondary">
                    View Results
                </a>
                <a href="{{ url_for('main.calendar_view') }}" class="btn btn-secondary">
                    Competition Calendar
                </a>
            </div>
        </div>
        {% endif %}

        <div class="user-info">
            <p class="role-badge role-{{ current_user.role_id }}">
                {% if current_user.is_admin %}
                Administrator
                {% elif current_user.is_judge_or_admin %}
                Judge
                {% else %}
                Member
                {% endif %}
            </p>
            <a href="{{ url_for('main.logout') }}" class="btn btn-outline btn-sm">Logout</a>
        </div>
    </section><!-- user-panel -->
    {% endif %}
</div><!-- content -->

{% endblock %}